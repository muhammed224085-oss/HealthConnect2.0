# ğŸ—ï¸ AI Chatbot Architecture - Visual Overview

## ğŸ“Š System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          USER INTERFACE LAYER                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AIHealthAssistant.js    â”‚    â”‚  FloatingChatbot.js          â”‚  â”‚
â”‚  â”‚  (/ai-assistant)         â”‚    â”‚  (All pages)                 â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ â€¢ Full page chat UI      â”‚    â”‚ â€¢ Bottom-right widget        â”‚  â”‚
â”‚  â”‚ â€¢ Quick questions        â”‚    â”‚ â€¢ Click to open/close        â”‚  â”‚
â”‚  â”‚ â€¢ Message history        â”‚    â”‚ â€¢ Mini chat window           â”‚  â”‚
â”‚  â”‚ â€¢ Doctor cards           â”‚    â”‚ â€¢ Same functionality         â”‚  â”‚
â”‚  â”‚ â€¢ Book appointment       â”‚    â”‚ â€¢ Compact design             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                       â”‚
â”‚                            â†“ axios.post()                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                     â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          REST API LAYER                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚                  â”‚   ChatBotController.java       â”‚                  â”‚
â”‚                  â”‚   (@RestController)            â”‚                  â”‚
â”‚                  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
â”‚                  â”‚  POST /api/chatbot/query       â”‚                  â”‚
â”‚                  â”‚  GET  /api/chatbot/history/:id â”‚                  â”‚
â”‚                  â”‚  DEL  /api/chatbot/history/:id â”‚                  â”‚
â”‚                  â”‚  GET  /api/chatbot/test        â”‚                  â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                                       â”‚
â”‚                            â†“ Service Layer                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                     â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BUSINESS LOGIC LAYER                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚         â”‚      GeminiAIService.java                  â”‚              â”‚
â”‚         â”‚      (@Service)                            â”‚              â”‚
â”‚         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚         â”‚  â€¢ getAIResponse()                         â”‚              â”‚
â”‚         â”‚    - Build healthcare prompt               â”‚              â”‚
â”‚         â”‚    - Call Gemini API                       â”‚              â”‚
â”‚         â”‚    - Parse JSON response                   â”‚              â”‚
â”‚         â”‚                                            â”‚              â”‚
â”‚         â”‚  â€¢ suggestDoctorSpecialization()          â”‚              â”‚
â”‚         â”‚    - Analyze symptoms                      â”‚              â”‚
â”‚         â”‚    - Map to specializations                â”‚              â”‚
â”‚         â”‚    - Return doctor type                    â”‚              â”‚
â”‚         â”‚                                            â”‚              â”‚
â”‚         â”‚  â€¢ determineMessageType()                 â”‚              â”‚
â”‚         â”‚    - Classify as SYMPTOM/DISEASE/etc      â”‚              â”‚
â”‚         â”‚                                            â”‚              â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                       â”‚
â”‚                      â†“                    â†“                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

            â†“ HTTP POST                      â†“ MongoDB

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   EXTERNAL API        â”‚          â”‚  DATA ACCESS LAYER     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤          â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                       â”‚          â”‚                        â”‚
â”‚  Google Gemini API    â”‚          â”‚  ChatMessageRepository â”‚
â”‚  (AI Model)           â”‚          â”‚  (@Repository)         â”‚
â”‚                       â”‚          â”‚                        â”‚
â”‚  â€¢ gemini-pro model   â”‚          â”‚  DoctorRepository      â”‚
â”‚  â€¢ JSON request       â”‚          â”‚  (@Repository)         â”‚
â”‚  â€¢ JSON response      â”‚          â”‚                        â”‚
â”‚  â€¢ Natural language   â”‚          â”‚                        â”‚
â”‚                       â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â†“

                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚   DATABASE LAYER       â”‚
                                   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                   â”‚                        â”‚
                                   â”‚  MongoDB (port 27017)  â”‚
                                   â”‚  Database: healthconnectâ”‚
                                   â”‚                        â”‚
                                   â”‚  Collections:          â”‚
                                   â”‚  â€¢ chat_history        â”‚
                                   â”‚  â€¢ doctors             â”‚
                                   â”‚  â€¢ patients            â”‚
                                   â”‚  â€¢ medicines           â”‚
                                   â”‚  â€¢ appointments        â”‚
                                   â”‚  â€¢ prescriptions       â”‚
                                   â”‚  â€¢ orders              â”‚
                                   â”‚  â€¢ messages            â”‚
                                   â”‚  â€¢ admins              â”‚
                                   â”‚                        â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request-Response Flow

### Scenario: User asks "I have chest pain"

```
Step 1: User Input
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FloatingChatbot.js               â”‚
â”‚ User types: "I have chest pain"  â”‚
â”‚ Click Send button                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
              
Step 2: HTTP Request
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ axios.post('http://localhost:8080/api/chatbot/query') â”‚
â”‚ Body: {                                          â”‚
â”‚   message: "I have chest pain",                  â”‚
â”‚   patientId: "patient123",                       â”‚
â”‚   patientName: "John Doe"                        â”‚
â”‚ }                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
              
Step 3: Controller Receives Request
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ChatBotController.handleChatQuery()â”‚
â”‚ â€¢ Extract message                 â”‚
â”‚ â€¢ Validate input                  â”‚
â”‚ â€¢ Call GeminiAIService            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
              
Step 4: AI Service Processing
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GeminiAIService                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                â”‚
â”‚ 4a. Build Prompt:                              â”‚
â”‚     "You are a medical AI assistant..."        â”‚
â”‚     + "User Query: I have chest pain"          â”‚
â”‚                                                â”‚
â”‚ 4b. Call Gemini API:                           â”‚
â”‚     POST https://generativelanguage.googleapis.com/...â”‚
â”‚     with API key                               â”‚
â”‚                                                â”‚
â”‚ 4c. Parse Response:                            â”‚
â”‚     Extract text from JSON                     â”‚
â”‚                                                â”‚
â”‚ 4d. Analyze Symptoms:                          â”‚
â”‚     "chest pain" â†’ Cardiologist               â”‚
â”‚                                                â”‚
â”‚ 4e. Classify Message:                          â”‚
â”‚     Type: SYMPTOM                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
              
Step 5: Find Doctor
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DoctorRepository                  â”‚
â”‚ findAll() â†’ filter by specializationâ”‚
â”‚ Find: Dr. Aarav Nair (Cardiologist)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
              
Step 6: Save Chat History
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ChatMessageRepository.save()                   â”‚
â”‚ {                                              â”‚
â”‚   patientId: "patient123",                     â”‚
â”‚   userMessage: "I have chest pain",            â”‚
â”‚   botResponse: "Based on your symptoms...",    â”‚
â”‚   suggestedSpecialization: "Cardiologist",     â”‚
â”‚   suggestedDoctor: "Dr. Aarav Nair",          â”‚
â”‚   messageType: "SYMPTOM",                      â”‚
â”‚   timestamp: "2025-10-17T23:03:45"            â”‚
â”‚ }                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
              
Step 7: Build Response
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ChatBotController                              â”‚
â”‚ Return ResponseEntity with:                    â”‚
â”‚ {                                              â”‚
â”‚   message: "AI response text",                 â”‚
â”‚   messageType: "SYMPTOM",                      â”‚
â”‚   suggestedSpecialization: "Cardiologist",     â”‚
â”‚   suggestedDoctor: {                           â”‚
â”‚     id: "doc1",                                â”‚
â”‚     name: "Dr. Aarav Nair",                    â”‚
â”‚     specialization: "Cardiologist",            â”‚
â”‚     qualification: "MD Cardiology",            â”‚
â”‚     experience: "15 years"                     â”‚
â”‚   },                                           â”‚
â”‚   timestamp: "..."                             â”‚
â”‚ }                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
              
Step 8: Display Response
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FloatingChatbot.js                             â”‚
â”‚ â€¢ Add bot message to chat                      â”‚
â”‚ â€¢ Show AI response text                        â”‚
â”‚ â€¢ Display doctor recommendation card:          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚ ğŸ‘¨â€âš•ï¸ Recommended Doctor         â”‚            â”‚
â”‚   â”‚ Name: Dr. Aarav Nair         â”‚            â”‚
â”‚   â”‚ Specialization: Cardiologist â”‚            â”‚
â”‚   â”‚ [ğŸ“… Book Appointment]        â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚ â€¢ Stop typing animation                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Database Schema

### chat_history Collection

```
Document Structure:
{
  _id: ObjectId("67123abc..."),           // MongoDB auto-generated
  patientId: "patient123",                 // Who asked
  patientName: "John Doe",                 // Patient name
  userMessage: "I have chest pain",        // User's question
  botResponse: "Based on your symptoms...", // AI's answer
  suggestedDoctor: "Dr. Aarav Nair",      // Recommended doctor
  suggestedSpecialization: "Cardiologist", // Doctor type
  timestamp: ISODate("2025-10-17T17:33:45Z"), // When
  messageType: "SYMPTOM"                   // Classification
}

Indexes:
- patientId (for fast retrieval)
- timestamp (for sorting)
```

---

## ğŸ§  AI Decision Logic

### Symptom â†’ Doctor Mapping

```
User Message Analysis:
â”œâ”€ Contains "chest pain" OR "heart" OR "shortness of breath"
â”‚  â””â”€> Suggest: Cardiologist
â”‚
â”œâ”€ Contains "skin" OR "rash" OR "acne" OR "eczema"
â”‚  â””â”€> Suggest: Dermatologist
â”‚
â”œâ”€ Contains "child" OR "baby" OR "infant"
â”‚  â””â”€> Suggest: Pediatrician
â”‚
â”œâ”€ Contains "headache" OR "migraine" OR "seizure" OR "dizzy"
â”‚  â””â”€> Suggest: Neurologist
â”‚
â”œâ”€ Contains "bone" OR "joint" OR "fracture" OR "back pain"
â”‚  â””â”€> Suggest: Orthopedic
â”‚
â”œâ”€ Contains "ear" OR "nose" OR "throat" OR "sinus"
â”‚  â””â”€> Suggest: ENT Specialist
â”‚
â”œâ”€ Contains "stomach" OR "abdomen" OR "nausea" OR "vomiting"
â”‚  â””â”€> Suggest: Gastroenterologist
â”‚
â”œâ”€ Contains "eye" OR "vision" OR "blurry"
â”‚  â””â”€> Suggest: Ophthalmologist
â”‚
â””â”€ No specific keywords
   â””â”€> Default: General Physician
```

### Message Type Classification

```
Message Content Check:
â”œâ”€ Contains "medicine" OR "tablet" OR "drug" OR medicine names
â”‚  â””â”€> Type: MEDICINE
â”‚
â”œâ”€ Contains "what is" OR "disease" OR disease names
â”‚  â””â”€> Type: DISEASE
â”‚
â”œâ”€ Contains "pain" OR "fever" OR "cough" OR "feel" OR symptom words
â”‚  â””â”€> Type: SYMPTOM
â”‚
â””â”€ Everything else
   â””â”€> Type: GENERAL
```

---

## ğŸ” Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Frontend (React)            â”‚
â”‚  â€¢ No API keys stored               â”‚
â”‚  â€¢ HTTPS in production              â”‚
â”‚  â€¢ Input sanitization               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“ HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    CORS Configuration               â”‚
â”‚  â€¢ Allow: localhost:3000            â”‚
â”‚  â€¢ Allow: localhost:3001            â”‚
â”‚  â€¢ Production: specific domain      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend (Spring Boot)             â”‚
â”‚  â€¢ API key in application.propertiesâ”‚
â”‚  â€¢ Not exposed to frontend          â”‚
â”‚  â€¢ Input validation (@Valid)        â”‚
â”‚  â€¢ Rate limiting (TODO)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Google Gemini API               â”‚
â”‚  â€¢ API key authentication           â”‚
â”‚  â€¢ HTTPS only                       â”‚
â”‚  â€¢ Rate limits apply                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     MongoDB Database                â”‚
â”‚  â€¢ Local connection (dev)           â”‚
â”‚  â€¢ Authentication (production)      â”‚
â”‚  â€¢ Patient data privacy             â”‚
â”‚  â€¢ Chat history per patient         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± Component Interaction Map

### FloatingChatbot Component Tree

```
FloatingChatbot.js
â”œâ”€ State Management
â”‚  â”œâ”€ isOpen: boolean
â”‚  â”œâ”€ messages: Array<Message>
â”‚  â”œâ”€ inputMessage: string
â”‚  â””â”€ isLoading: boolean
â”‚
â”œâ”€ UI Components
â”‚  â”œâ”€ Floating Button (ğŸ¤–)
â”‚  â”‚  â””â”€ onClick: toggleChat()
â”‚  â”‚
â”‚  â””â”€ Chat Window (conditional)
â”‚     â”œâ”€ Header
â”‚     â”‚  â”œâ”€ Title: "AI Health Assistant"
â”‚     â”‚  â””â”€ Close Button
â”‚     â”‚
â”‚     â”œâ”€ Messages Area
â”‚     â”‚  â”œâ”€ Message Bubbles
â”‚     â”‚  â”‚  â”œâ”€ User messages (blue)
â”‚     â”‚  â”‚  â””â”€ Bot messages (gray)
â”‚     â”‚  â”‚
â”‚     â”‚  â””â”€ Doctor Cards (conditional)
â”‚     â”‚     â”œâ”€ Doctor name
â”‚     â”‚     â”œâ”€ Specialization
â”‚     â”‚     â””â”€ Book button
â”‚     â”‚
â”‚     â””â”€ Input Area
â”‚        â”œâ”€ Text input
â”‚        â””â”€ Send button
â”‚
â””â”€ API Integration
   â””â”€ handleSendMessage()
      â”œâ”€ axios.post('/api/chatbot/query')
      â”œâ”€ Update messages state
      â””â”€ Show/hide loading
```

### AIHealthAssistant Component Tree

```
AIHealthAssistant.js
â”œâ”€ State Management
â”‚  â”œâ”€ messages: Array<Message>
â”‚  â”œâ”€ inputMessage: string
â”‚  â”œâ”€ isLoading: boolean
â”‚  â””â”€ patient: Object
â”‚
â”œâ”€ UI Layout
â”‚  â”œâ”€ Header Section
â”‚  â”‚  â”œâ”€ ğŸ¤– Avatar
â”‚  â”‚  â”œâ”€ Title
â”‚  â”‚  â””â”€ Subtitle
â”‚  â”‚
â”‚  â”œâ”€ Chat Container (600px height)
â”‚  â”‚  â”œâ”€ Messages Area (scrollable)
â”‚  â”‚  â”‚  â”œâ”€ Welcome message
â”‚  â”‚  â”‚  â”œâ”€ User/Bot messages
â”‚  â”‚  â”‚  â””â”€ Loading indicator
â”‚  â”‚  â”‚
â”‚  â”‚  â”œâ”€ Quick Questions (first time)
â”‚  â”‚  â”‚  â””â”€ 4 preset questions
â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€ Input Form
â”‚  â”‚     â”œâ”€ Text input (full width)
â”‚  â”‚     â””â”€ Send button
â”‚  â”‚
â”‚  â””â”€ Disclaimer
â”‚     â””â”€ Medical advice warning
â”‚
â””â”€ Features
   â”œâ”€ Auto-scroll to bottom
   â”œâ”€ Timestamp display
   â”œâ”€ Doctor recommendation cards
   â””â”€ Book appointment integration
```

---

## ğŸš€ Deployment Architecture (Production)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CLIENT DEVICES                         â”‚
â”‚  Desktop Browsers  |  Mobile Browsers  |  Tablets            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CDN / Load Balancer                   â”‚
â”‚  â€¢ SSL/TLS Termination                                       â”‚
â”‚  â€¢ Static file caching                                       â”‚
â”‚  â€¢ DDoS protection                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend Server    â”‚            â”‚   Backend Server     â”‚
â”‚   (React App)        â”‚            â”‚   (Spring Boot)      â”‚
â”‚   â€¢ Nginx/Apache     â”‚            â”‚   â€¢ Port 8080        â”‚
â”‚   â€¢ Static files     â”‚            â”‚   â€¢ REST API         â”‚
â”‚   â€¢ Service Worker   â”‚            â”‚   â€¢ Business Logic   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â†“
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â†“                 â†“                 â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Gemini API     â”‚ â”‚  MongoDB   â”‚ â”‚  File Storage  â”‚
                    â”‚  (Google Cloud) â”‚ â”‚  (Atlas)   â”‚ â”‚  (Optional)    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Patient   â”‚
â”‚   (User)    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 1. Types health question
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend   â”‚ â”€â”€â”€â”€â”€ 2. POST /api/chatbot/query â”€â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   (React)   â”‚                                          â”‚   Backend    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â†â”€â”€â”€â”€ 10. Display response + doctor â”€â”€â”€ â”‚ (Spring Boot)â”‚
       â”‚                                                 â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                                        â”‚
       â”‚ 11. Show doctor card                                  â”‚ 3. Validate input
       â”‚                                                        â†“
       â†“                                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚ GeminiAI     â”‚
â”‚ Book        â”‚                                         â”‚ Service      â”‚
â”‚ Appointment â”‚                                         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ Button      â”‚                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                â”‚ 4. Build prompt
                                                               â†“
                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                        â”‚  Gemini API  â”‚
                                                        â”‚  (Google)    â”‚
                                                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚ 5. AI generates
                                                               â”‚    response
                                                               â†“
                                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                        â”‚ Parse JSON   â”‚
                                                        â”‚ Response     â”‚
                                                        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                               â”‚
                                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                â†“              â†“              â†“
                                         6. Analyze    7. Find        8. Save
                                         symptoms      doctor         history
                                                â†“              â†“              â†“
                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                         â”‚ Suggest  â”‚ â”‚ Doctor   â”‚ â”‚ Chat     â”‚
                                         â”‚ Special. â”‚ â”‚ Repo     â”‚ â”‚ Message  â”‚
                                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ Repo     â”‚
                                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                         â”‚
                                                                         â†“
                                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                                    â”‚ MongoDB  â”‚
                                                                    â”‚ chat_    â”‚
                                                                    â”‚ history  â”‚
                                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ UI Component Hierarchy

```
App.js
â”‚
â”œâ”€ Router
â”‚  â”‚
â”‚  â”œâ”€ Route: /ai-assistant
â”‚  â”‚  â””â”€ AIHealthAssistant
â”‚  â”‚     â”œâ”€ Header (AI branding)
â”‚  â”‚     â”œâ”€ ChatContainer
â”‚  â”‚     â”‚  â”œâ”€ MessageList
â”‚  â”‚     â”‚  â”‚  â”œâ”€ WelcomeMessage
â”‚  â”‚     â”‚  â”‚  â”œâ”€ UserMessage[]
â”‚  â”‚     â”‚  â”‚  â”œâ”€ BotMessage[]
â”‚  â”‚     â”‚  â”‚  â”‚  â””â”€ DoctorCard (conditional)
â”‚  â”‚     â”‚  â”‚  â””â”€ LoadingIndicator
â”‚  â”‚     â”‚  â”‚
â”‚  â”‚     â”‚  â”œâ”€ QuickQuestions (initial)
â”‚  â”‚     â”‚  â””â”€ InputForm
â”‚  â”‚     â”‚
â”‚  â”‚     â””â”€ Disclaimer
â”‚  â”‚
â”‚  â”œâ”€ Route: /patient/dashboard
â”‚  â”œâ”€ Route: /doctor/dashboard
â”‚  â””â”€ ... (other routes)
â”‚
â””â”€ FloatingChatbot (global)
   â”œâ”€ FloatingButton
   â””â”€ ChatWindow (conditional)
      â”œâ”€ ChatHeader
      â”œâ”€ MessageList
      â”‚  â”œâ”€ Message[]
      â”‚  â””â”€ TypingIndicator
      â””â”€ InputForm
```

---

**Architecture Documentation Complete! ğŸ‰**

This visual overview provides a comprehensive understanding of how all components interact in the AI Chatbot system.
